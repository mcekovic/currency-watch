<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
	<title>#{chartPage.title}</title>
	<script type="text/javascript">
		function setMovAvgPeriodEnabled() {
			var showMovAvg = document.getElementById("chartForm:showMovAvg");
			var showBollBands = document.getElementById("chartForm:showBollBands");
			var movAvgPeriod = document.getElementById("chartForm:movAvgPeriod");
			movAvgPeriod.disabled = !(showMovAvg.checked || showBollBands.checked);
		}
		function showLoadingLabel() {
			var chartImage = document.getElementById("chartImage");
			var loadingDiv = document.getElementById("loadingDiv");
			if (chartImage)
				chartImage.style.display = "none";
			loadingDiv.style.display = "inline";
		}
	</script>
</h:head>
<h:body>
	<h:outputStylesheet name="currency-watch.css" library="css"/>
	<h1>Currency Watch</h1>
	<h:form id="chartForm" onsubmit="showLoadingLabel()">
		<table cellspacing="10"><tr>
			<td>
				<h:outputLabel for="currency" value="Currency: "/>
				<h:selectOneMenu id="currency" value="#{chartPage.currency}" title="Currency">
					<f:selectItems value="#{chartPage.currencies}" />
				</h:selectOneMenu>
			</td>
			<td>
				<h:outputLabel for="period" value="Period: "/>
				<h:selectOneMenu id="period" value="#{chartPage.period}" title="Chart period">
					<f:selectItems value="#{chartPage.periods}"/>
				</h:selectOneMenu>
			</td>
			<td>
				<h:outputLabel for="quality" value="Quality: "/>
				<h:selectOneMenu id="quality" value="#{chartPage.quality}" title="Series quality">
					<f:selectItems value="#{chartPage.qualities}"/>
				</h:selectOneMenu>
			</td>
			<td>
				<h:selectBooleanCheckbox id="showBidAsk" value="#{chartPage.showBidAsk}" title="Show Bid and Ask"/>
				<h:outputLabel for="showBidAsk" value="Bid/Ask"/>
			</td>
			<td>
				<h:selectBooleanCheckbox id="showMovAvg" value="#{chartPage.showMovAvg}" title="Show Moving Average" onchange="setMovAvgPeriodEnabled()"/>
				<h:outputLabel for="showMovAvg" value="Mov. Avg."/>
			</td>
			<td>
				<h:selectBooleanCheckbox id="showBollBands" value="#{chartPage.showBollBands}" title="Show Bollinger Bands" onchange="setMovAvgPeriodEnabled()"/>
				<h:outputLabel for="showBollBands" value="Boll. Bands"/>
			</td>
			<td>
				<h:selectOneMenu id="movAvgPeriod" value="#{chartPage.movAvgPeriod}" title="Moving Average period" disabled="true">
					<f:selectItems value="#{chartPage.movAvgPeriods}"/>
				</h:selectOneMenu>
			</td>
			<td>
				<h:commandButton id="showChart" value="Show Chart" action="#{chartPage.showChart}" onclick="submit()"/>
			</td>
		</tr></table>
	</h:form>
	<c:if test="#{!empty chartPage.chartFileName}">
		<h:graphicImage id="chartImage" url="servlet/DisplayChart?filename=#{chartPage.chartFileName}" width="#{chartPage.chartWidth}" height="#{chartPage.chartHeight}" alt="Currency Chart for #{chartPage.currency} (#{chartPage.currency.description()})"/>
	</c:if>
	<div id="loadingDiv" style="display: none; width: #{chartPage.chartWidth}; height: #{chartPage.chartHeight};">
		<div style="width: 50%; margin: 0 auto;">
			<h:graphicImage url="resources/images/loading.gif" width="66" height="66" alt="Loading..."/>
		</div>
	</div>
</h:body>
</html>